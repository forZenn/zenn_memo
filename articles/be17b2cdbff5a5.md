---
title: "manjaroã®bootstrapã‚’ä½œã£ã¦ã¿ãŸã€‚"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Linux", "ä»®æƒ³ç’°å¢ƒ", "Arch Linux", "manjaro"]
published: true
---

## bootstrapã¨ã¯ï¼Ÿ

æ—¢ã«osãŒå…¥ã£ã¦ã„ã‚‹PCã«chrootä»®æƒ³ç’°å¢ƒã‚’ä½¿ã£ã¦ã€osã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ãã®å‡¦ç†ã‚’æ‰‹ä¼ã£ã¦ãã‚Œã‚‹ã‚‚ã®ã€‚
ä¸€èˆ¬ã«/mnt/osnameã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã£ã¦ã€ãã“ã«/dev/sdxãªã©ãƒ‡ãƒã‚¤ã‚¹ã‚’ãƒã‚¦ãƒ³ãƒˆã•ã›ã¦ã€ãã“ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ã„ã†æ‰‹æ³•ã§ã™ã€‚
chrootç’°å¢ƒã¯vagrant,dockerç’°å¢ƒã«æ¯”ã¹ã¦è¦æ±‚ã•ã‚Œã‚‹ã‚¹ãƒšãƒƒã‚¯ãŒä½ã„ã®ã§ã€
ãƒ¡ãƒ¢ãƒª4Gãªã©ã®ä½ã‚¹ãƒšãƒƒã‚¯ã§ã‚‚ä»®æƒ³ç’°å¢ƒã‚’æ¥½ã«å‹•ã‹ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

## manjaroã®bootstrapãŒå¤ãdefualtã¯unstable

manjaroã«ã¯manjaro-bootstrapãŒã‚ã‚‹ãŒã€
manjaro-bootstrapã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯githubã¨gitlabã«ã‚ã‚Šã€
githubå´ã¯æ—¢ã«archiveæ¸ˆã¿ã€gitlabã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ãƒ–ãƒ©ãƒ³ãƒãŒunstableã«æ±ºã‚ã†ã¡ã•ã‚Œã¦ã„ã¦ã€
ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨ã€manjaro linuxé–‹ç™ºè€…ç”¨ã®ã‚‚ã®ã ã‚ã†ã€‚

ãªã®ã§ã€ä¸€èˆ¬manjaroãƒ¦ãƒ¼ã‚¶ãƒ¼ç”¨ã®bootstrapã‚’ä½œã‚‹ãªã‚‰ã€è‡ªåˆ†ã§æ›¸ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
0ã‹ã‚‰æ›¸ãã®ã¯å¤§å¤‰ãªã®ã§ã€manjaroã®upstreamã«ã‚ãŸã‚‹arch linux ã®bootstrap
ã‚’å‚è€ƒã«ã—ãŸã„ã€‚

## manjaro-bootstrap

archlinuxã«ã¯arch-bootstrapã¨ã„ã†bootstrapç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒ
ã‚ã‚Šã€archwikiã«githubã¸ã®ãƒªãƒ³ã‚¯ãŒã‚ã‚‹ã€‚
[archwiki](https://wiki.archlinux.jp/index.php/%E6%97%A2%E5%AD%98%E3%81%AE_Linux_%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB)
[github arch-bootstrap](https://github.com/tokland/arch-bootstrap)

ã“ã‚Œã‚’ãƒ•ã‚©ãƒ¼ã‚¯ã—ã¦manjaroç”¨ã®bootstrapã‚’ä½œã£ãŸã€‚
[manjaro-bootstrap](https://github.com/KatsutoshiOtogawa/manjaro-bootstrap)

## è¦ä»¶

ãƒ›ã‚¹ãƒˆå´ãŒlinux osã§ã‚ã‚‹ã“ã¨ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

githubã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã¦ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã§é©åˆ‡ãªå ´æ‰€ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚

```bash
wget https://raw.githubusercontent.com/KatsutoshiOtogawa/manjaro-bootstrap/main/manjaro-bootstrap.sh
sudo install -m 755 manjaro-bootstrap.sh /usr/local/bin/manjaro-bootstrap
```

## ä½¿ã„æ–¹

åŸºæœ¬çš„ã«ã¯ãƒ•ã‚©ãƒ¼ã‚¯å…ƒã®archlinux-bootstrapã¨ä½¿ã„æ–¹åŒã˜ã§ã™ã€‚

```bash
# ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
manjaro-bootstrap -h
```

ä½¿ã„æ–¹æµã‚Œ

```bash
# mountç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
sudo mkdir /mnt/manjaro
# ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒã‚¦ãƒ³ãƒˆ(ã‚ã‚‰ã‹ã˜ã‚ext4ãªã©ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¦ãŠãã“ã¨ã€‚)
sudo mount /dev/sdbx /mnt/manjaro
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo manjaro-bootstrap -r repositoryã®url -a x86_64ãªã©cpu /mnt/manjaro
# ãƒ—ãƒ­ã‚»ã‚¹ã‚„ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã‚’chrootç’°å¢ƒã«ãƒã‚¦ãƒ³ãƒˆ
sudo mount --types proc /proc myarch/proc
sudo mount --rbind       /sys myarch/sys
sudo mount --make-rslave      myarch/sys
sudo mount --rbind       /dev myarch/dev
sudo mount --make-rslave      myarch/dev
sudo mount --bind        /run myarch/run
sudo mount --make-slave       myarch/run

# chroot
sudo /mnt/manjaro /bin/bash
pacman -S manjaro_release # ãªã©è‡ªåˆ†ã«å¿…è¦ãªã‚‚ã®ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã€‚
...
```

chrootæŠœã‘ã‚‹å ´åˆã€‚

```bash
$ exit
# chrootæŠœã‘ãŸå¾Œ
$ sudo umount -l /mnt/manjaro/dev{/pts,/shm,}
$ sudo umount -R /mnt/manjaro
```

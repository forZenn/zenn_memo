---
title: "gnu,bsdã‚³ãƒãƒ³ãƒ‰ã®å·®ã‚’å¸åã—ã‚ˆã†"
emoji: "ğŸ“‘"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Bash", "Linux", "macOS", "BSD", "Debian"]
published: true
---

linuxã¨ãã®ä»–ã®unixã€ä¾‹ãˆã°macãªã©ä¸¡æ–¹ã‚’ä½¿ã†
ç’°å¢ƒã®äººã‚‚å¤šã„ã ã‚ã†ã€‚

ãã®å ´åˆã¯gnuã‚³ãƒãƒ³ãƒ‰ãªã®ã‹ã€bsdã‚³ãƒãƒ³ãƒ‰ãªã®ã‹ã§æ··ä¹±ã™ã‚‹ã“ã¨ã‚‚å¤šã„ã€‚
ã¾ãŸã€Linuxã§ã‚‚Debianç³»ã¯gawkã§ãªãã€mawkã¨ã„ã†å°‘æ©Ÿèƒ½ã ãŒã€é€Ÿåº¦ãŒæ”¹å–„ã•ã‚Œã¦ã„ã‚‹
awkã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚æ™®é€šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§mawkã˜ã‚ƒãªã„ã¨ãƒ€ãƒ¡ã¨ã„ã†ã“ã¨ã¯ãªãã€
ã‚€ã—ã‚gawkã§ä½¿ã„ãŸã„é–¢æ•°ãŒä½¿ãˆãªã„å¼Šå®³ã®ã»ã†ãŒå¤§ãã„ãŸã‚ã€ã“ã‚Œã‚‚gawkã§ç½®ãæ›ãˆã‚‹ã€‚

ã»ã¨ã‚“ã©ã®å ´åˆã¯gnuã‚³ãƒãƒ³ãƒ‰ã®æ–¹ãŒä½¿ã„å‹æ‰‹ãŒè‰¯ãã€
ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚‚ç°¡æ½”ã«ãªã‚‹ã€‚

ã“ã®äºŒã¤ã®ã‚³ãƒãƒ³ãƒ‰ã®å·®ã‚’å¸åã™ã‚‹æ–¹æ³•ã‚’æ›¸ãã€‚

## ã‚„ã‚Šæ–¹

ã‚³ãƒãƒ³ãƒ‰åã®functionã‚’å®šç¾©ã—ã¦ã€ãã®ã‚³ãƒãƒ³ãƒ‰ã®ä¸­ã§gnuã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨
gnuã‚³ãƒãƒ³ãƒ‰ã¨bsdã‚³ãƒãƒ³ãƒ‰ã®å·®ã‚’å¸åã§ãã‚‹ã€‚
aliasã§ã‚³ãƒãƒ³ãƒ‰åã‚’å®šç¾©ã™ã‚‹ã¨ã€å¯¾è©±å½¢å¼ã®ã¿ã§æœ‰åŠ¹ã«ãªã‚Šã€
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ããªã„ã®ã§ã€functionã§å®šç¾©ã™ã‚‹æ–¹æ³•ã—ã‹å–ã‚Œãªã„ã€‚

ä¸‹ã®ã‚ˆã†ãªé–¢æ•°ãŒè‰¯ã„ã ã‚ã†ã€‚

```bash:ä¾‹
function sed {
  gsed "$@"
}
```

ã¾ãŸã“ã®ä¸Šæ›¸ãå‡¦ç†ã‚’~/.bashrcãªã©ã«ç›´æ¥æ›¸ãã¨å½±éŸ¿ç¯„å›²ãŒåºƒéãã¦
æ—¢å­˜ã®å‡¦ç†ã‚’é‚ªé­”ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
ã‚ˆã£ã¦ã€ä½¿ã„ãŸã„ã¨ãã«ã ã‘gnu,bsdã‚³ãƒãƒ³ãƒ‰ã®å¸åã™ã‚‹å‡¦ç†ã‚’èª­ã‚“ã§ã€
å¥½ããªã¨ãã«å¤‰æ›´ã‚’ç ´æ£„ã™ã‚‹å‡¦ç†ãŒã‚ã‚‹ã¨è‰¯ã„ã€‚

.bashrcã«ä¸Šæ›¸ãé–¢æ•°ç¾¤ã‚’èª­ã¿è¾¼ã‚€é–¢æ•°ã®å®šç¾©ã‚’æ›¸ãã‹ã€
é–¢æ•°ç¾¤ã‚’èª­ã¿è¾¼ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’sourceã™ã‚‹ã¨ä¸Šæ‰‹ãã„ãã‹ã€‚

ã“ã®ã‚„ã‚Šæ–¹ã ã¨ã€å­ãƒ—ãƒ­ã‚»ã‚¹ã§å·®ã‚’å¸åã™ã‚‹å‡¦ç†ã‚’èª­ã‚“ã§ã‚‚ã€
è¦ªã‚„ãã®ä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã«å½±éŸ¿ãŒãªã„ãŸã‚ã€ä½¿ã„ã‚„ã™ã„ã¯ãšã€‚

## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

```bash:$HOME/.bashrc
# é–¢æ•°ç¾¤ã‚’èª­ã¿è¾¼ã‚€ã‚³ãƒãƒ³ãƒ‰
source $HOME/bash/function/read_function
```

```bash:$HOME/bash/function/read_function
# $HOME/bash/function/é…ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã™ã¹ã¦èª­ã¿è¾¼ã‚€é–¢æ•°
function read_function {

  local function_dir=$HOME/bash/function

  eval "$(
    ls ${function_dir} |
    grep -v .md |
    grep -v read_function |
    xargs -I {} echo source ${function_dir}/{};
  )"
  unset -f read_function
}

read_function
```

ä¸Šã®read_functionã«ã‚ˆã‚Šèª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚

```bash:$HOME/bash/function/gnu_alias
#!/bin/bash
#
# gnu command util.

#######################################
# set alias gnu command for Mac and BSD.
# Globals:
#   GNU_ALIAS
# Arguments:
#   None
# Outputs:
#   None
# Returns:
#   0 if  set alias, non-zero on error.
# Example:
#   gnu_alias # => you use use sed
#######################################
function gnu_alias {
    for arg in "$@"; do
    case "$arg" in
      -h|--help)
        function usage() {
          cat 1>&2 << END
gnu_alias
output search engine setting

USAGE:
    gnu_alias [FLAGS] [OPTIONS]

FLAGS:
    -h, --help              Prints help information

OPTIONS:
    --debug                 Set bash debug Option
END
          unset -f usage
        }
        usage
        return
        ;;
      --debug)
        # set debug
        set -x
        trap "
          set +x
          trap - RETURN
        " RETURN
        ;;
      *)
        ;;
    esac
  done

  # you use Darwin, set alias for use Gnu sed, awk, xargs
  if uname | grep -e Darwin -e BSD > /dev/null; then
    if ! gnu_exists; then
      echo "Any Gnu command is not exists." >&2
      return 1
    fi

    function getopt {
      if uname | grep -e Open > /dev/null; then
        # openbsd
        /usr/local/bin/gnugetopt "$@"
      elif uname | grep -e Free > /dev/null; then
        # freebsd
        /usr/local/bin/getopt "$@"
      elif uname | grep -e Darwin > /dev/null; then
        # macos
        # darwin
        /usr/local/opt/gnu-getopt/bin/getopt "$@"
      fi
    }
    
    # alias not using shellscript in norepl.
    # and using function for alternative alias.
    function sed {
      gsed "$@"
    }
    function awk {
      gawk "$@"
    }
    function xargs {
      gxargs "$@"
    }
    function find {
      gfind "$@"
    }
    function date {
      gdate "$@"
    }
    function cut {
      gcut "$@"
    }
    function df {
      gdf "$@"
    }

    export GNU_ALIAS=yes
  # debian default awk is mawk.
  # alias gawk.
  elif ls /etc | grep debian_version >> /dev/null; then
    if ! gnu_exists; then
      echo "Any Gnu command is not exists." >&2
      return 1
    fi
    function awk {
      gawk "$@"
    }
    export GNU_ALIAS=yes
  fi
}

#######################################
# check exists gnu command alias gnu command for Mac and BSD.
# gsed, gawk, gxargs, gfind, ... and many
# Globals:
#   None
# Arguments:
#   None
# Outputs:
#   None
# Returns:
#   0 if exists gnu commands, non-zero on error.
# Example:
#   gnu_exists # => you use use sed
#######################################
function gnu_exists {
  # you use Darwin, set alias for use Gnu sed, awk, xargs
  if uname | grep -e Darwin -e BSD > /dev/null; then
    # gsedãŒãªã‹ã£ãŸã‚‰ã€return 1

    # gnu-getopt
    if uname | grep -e Open > /dev/null; then
      # openbsd
      if ! type "/usr/local/bin/gnugetopt" > /dev/null; then
        echo "gnu-getopt is not exists." >&2
        return 1
      fi
    elif uname | grep -e Free > /dev/null; then
      # freebsd
      if ! type "/usr/local/bin/getopt" > /dev/null; then
        echo "gnu-getopt is not exists." >&2
        return 1
      fi
    elif uname | grep -e Darwin > /dev/null; then
      # macos
      # darwin
      if ! type "/usr/local/opt/gnu-getopt/bin/getopt" > /dev/null; then
        echo "gnu-getopt is not exists." >&2
        return 1
      fi
    else
      echo "unknown Unix!" >&2
      return 1
    fi

    if ! type "gsed" > /dev/null; then
      echo "gsed is not exists." >&2
      return 1
    fi
    if ! type "gawk" > /dev/null; then
      echo "gawk is not exists." >&2
      return 1
    fi
    if ! type "gxargs" > /dev/null; then
      echo "gxargs is not exists." >&2
      return 1
    fi
    if ! type "gfind" > /dev/null; then
      echo "gfind is not exists." >&2
      return 1
    fi
    if ! type "gdate" > /dev/null; then
      echo "gdate is not exists." >&2
      return 1
    fi
    if ! type "gcut" > /dev/null; then
      echo "gcut is not exists." >&2
      return 1
    fi
    if ! type "gdf" > /dev/null; then
      echo "gdf is not exists." >&2
      return 1
    fi
  # you use debian distribution, set alias awk.
  elif ls /etc | grep debian_version >> /dev/null; then
    if ! type "gawk" > /dev/null; then
      echo "gawk is not exists." >&2
      return 1
    fi
  fi
}

#######################################
# unalias gnu command for Mac.
# Globals:
#   GNU_ALIAS
# Arguments:
#   None
# Outputs:
#   None
# Returns:
#   0 if thing was deleted, non-zero on error.
# Example:
#   gnu_unalias # => you use use sed
#######################################
function gnu_unalias {
  # you use Darwin, set alias for use Gnu sed, awk, xargs
  if uname | grep -e Darwin -e BSD > /dev/null; then
    unset -f getopt
    unset -f sed
    unset -f awk
    unset -f xargs
    unset -f find
    unset -f date
    unset -f cut
    unset -f df
    unset GNU_ALIAS
  fi
  # you use debian distribution, set alias awk.
  if ls /etc | grep debian_version >> /dev/null; then
    
    unset -f awk
    unset GNU_ALIAS
  fi
}
```

## ä½¿ã„æ–¹

å¥½ããªã¨ãã«ä¸‹è¨˜ã®ã‚ˆã†ã«å¯¾è©±å½¢å¼ã§èª­ã‚“ã§ä¸‹è¨˜ã®ã‚ˆã†ã«ç ´æ£„ã™ã‚‹ã¨è‰¯ã„ã€‚

```bash
# overwrite bsd command to gnu command.
gnu_alias

# gnuã‚³ãƒãƒ³ãƒ‰ã«ç½®ãæ›ã‚ã£ã¦ã„ã‚‹ã®ã§-iã§sedã®ä¸Šæ›¸ããŒã§ãã‚‹ã€‚
sed -i.org /etc/hoge

# gnuã‚³ãƒãƒ³ãƒ‰ãŒä¸Šæ›¸ãã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã¯ä¸‹è¨˜ã®ç’°å¢ƒå¤‰æ•°ã«å…¥ã£ã¦ã„ã‚‹ã€‚
# ã“ã‚Œã‚’ã‚‚ã¨ã«åˆ¤æ–­ã™ã‚‹ã€‚
echo $GNU_ALIAS

# é–¢æ•°ã®ä¸Šæ›¸ãè§£é™¤
gnu_unalias
```

ä¸‹è¨˜ã®ã‚ˆã†ã«ä»–ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«çµ„ã¿è¾¼ã‚€ã®ã‚‚è‰¯ã„ã€‚

```bash:g++find_include.sh
function g++find_include {

  source $(dirname $0)/../function/gnu_alias
  if ! gnu_alias; then
    return 1;
  fi
  ...
}

g++find_include

```

ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆå‘¼ã³å‡ºã—ã€‚

```bash
bash g++find_include.sh
```

## æœ€æ–°ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

[github](https://github.com/KatsutoshiOtogawa/shell_script/blob/main/bash/function/gnu_alias)

---
title: "Powershellでレジストリの環境変数のチェック"
emoji: "🔥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Powershell", "Windows"]
published: true
---


自分用メモ

## 値の取得

プロセス環境変数は、レジストリには展開されない。

```powershell
# システム環境変数 HKLM -> HKEY_LOCAL_MACHINE 
Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment"
# 値のみ取得
Get-ItemPropertyValue "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" -Name Path
# キーの型を取得 ExpandString ([Microsoft.Win32.RegistryValueKind]) -> REG_EXPAND_SZ (レジストリ上)
(Get-Item "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment").GetValueKind('Path')

# ユーザー環境変数  HKCU -> HKEY_CURRENT_USER
Get-ItemProperty "HKCU:\Environment\"
# 値のみ取得
Get-ItemPropertyValue "HKCU:\Environment\" -Name Path
# キーの型を取得 ExpandString ([Microsoft.Win32.RegistryValueKind]) -> REG_EXPAND_SZ (レジストリ上)
(Get-Item "HKCU:\Environment").GetValueKind('Path')

# ユーザー環境変数(揮発性)
Get-ItemProperty "HKCU:\Volatile Environment\"
```
